<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Cheat Sheet</title>
    <link rel="stylesheet" href="documents/style.css">
</head>
<body>
    <a href="index.html" class="back-button">Retour</a>
    <h1>SQL Cheat Sheet - Les Bases</h1>
    <div class="section">
        <h2>Qu'est-ce que SQL ?</h2>
        <p>SQL (Structured Query Language) est un langage standardis√© pour g√©rer et manipuler des bases de donn√©es relationnelles. Il permet de :</p>
        <ul>
            <li>Cr√©er, modifier et supprimer des bases de donn√©es et des tables</li>
            <li>Ins√©rer, mettre √† jour et supprimer des donn√©es</li>
            <li>Effectuer des requ√™tes pour r√©cup√©rer des informations</li>
            <li>G√©rer les acc√®s aux donn√©es</li>
        </ul>
    </div>

    <div class="section">
        <h2>Cr√©ation de Table</h2>
        <p>La commande CREATE TABLE permet de cr√©er une nouvelle table dans la base de donn√©es.</p>
        <div class="example">
            <code>
                CREATE TABLE utilisateurs (<br>
                &nbsp;&nbsp;id INT PRIMARY KEY AUTO_INCREMENT,<br>
                &nbsp;&nbsp;nom VARCHAR(50) NOT NULL,<br>
                &nbsp;&nbsp;email VARCHAR(100) UNIQUE,<br>
                &nbsp;&nbsp;age INT,<br>
                &nbsp;&nbsp;date_inscription DATE<br>
                );
            </code>
        </div>
        <p>Types de donn√©es courants :</p>
        <ul>
            <li>VARCHAR(n) : Texte de longueur variable</li>
            <li>INT : Nombre entier</li>
            <li>DATE : Date</li>
            <li>DECIMAL(p,s) : Nombre d√©cimal</li>
            <li>BOOLEAN : Vrai/Faux</li>
        </ul>
    </div>

    <div class="section">
        <h2>Requ√™tes de Base</h2>
        
        <h3>SELECT - Lecture des donn√©es</h3>
        <div class="example">
            <code>
                -- S√©lectionner toutes les colonnes<br>
                SELECT * FROM utilisateurs;<br><br>
                -- S√©lectionner des colonnes sp√©cifiques<br>
                SELECT nom, email FROM utilisateurs;<br><br>
                -- Avec condition<br>
                SELECT * FROM utilisateurs WHERE age > 18;
            </code>
        </div>

        <h3>INSERT - Insertion de donn√©es</h3>
        <div class="example">
            <code>
                INSERT INTO utilisateurs (nom, email, age) <br>
                VALUES ('Jean Dupont', 'jean@email.com', 25);
            </code>
        </div>

        <h3>UPDATE - Mise √† jour</h3>
        <div class="example">
            <code>
                UPDATE utilisateurs<br>
                SET age = 26<br>
                WHERE nom = 'Jean Dupont';
            </code>
        </div>

        <h3>DELETE - Suppression</h3>
        <div class="example">
            <code>
                DELETE FROM utilisateurs<br>
                WHERE id = 1;
            </code>
        </div>
    </div>

    <div class="section">
        <h2>Jointures (JOINS)</h2>
        <p>Les jointures permettent de combiner des donn√©es de plusieurs tables.</p>

        <h3>Exemple avec deux tables</h3>
        <div class="example">
            <code>
                -- Structure des tables<br>
                CREATE TABLE utilisateurs (<br>
                &nbsp;&nbsp;id INT PRIMARY KEY AUTO_INCREMENT,<br>
                &nbsp;&nbsp;nom VARCHAR(50) NOT NULL,<br>
                &nbsp;&nbsp;email VARCHAR(100) UNIQUE,<br>
                &nbsp;&nbsp;age INT,<br>
                &nbsp;&nbsp;date_inscription DATE<br>
                );

                
                CREATE TABLE villes (<br>
                &nbsp;&nbsp;id INT PRIMARY KEY,<br>
                &nbsp;&nbsp;utilisateur_id INT,<br>
                &nbsp;&nbsp;name VARCHAR(50),<br>
                &nbsp;&nbsp;FOREIGN KEY (utilisateur_id) REFERENCES utilisateurs(id)<br>
                );<br><br>

                -- INNER JOIN<br>
                SELECT utilisateurs.nom, villes.name<br>
                FROM utilisateurs<br>
                INNER JOIN villes ON utilisateurs.id = villes.utilisateur_id;<br><br>

            </code>

        </div>

        <h3>Types de Jointures</h3>
        <ul>
            <li><strong>INNER JOIN</strong> : Retourne les enregistrements qui ont des correspondances dans les deux tables</li>
            <li><strong>LEFT JOIN</strong> : Retourne tous les enregistrements de la table de gauche et les correspondances de la table de droite</li>
            <li><strong>RIGHT JOIN</strong> : Retourne tous les enregistrements de la table de droite et les correspondances de la table de gauche</li>
            <li><strong>FULL JOIN</strong> : Retourne tous les enregistrements des deux tables</li>
        </ul>
    </div>

    <div class="section">
        <h2>Fonctions d'Agr√©gation Courantes</h2>
        <div class="example">
            <code>
                SELECT <br>
                &nbsp;&nbsp;COUNT(*) as total,<br>
                &nbsp;&nbsp;AVG(age) as moyenne_age,<br>
                &nbsp;&nbsp;MAX(age) as age_max,<br>
                &nbsp;&nbsp;MIN(age) as age_min<br>
                FROM utilisateurs;
            </code>
        </div>
    </div>
    <h2>Exemple avec cas pratiques</h2>
    <div class="section">
        <h3>Mod√©lisation d'une Base de Donn√©es pour un SAV (Service Apr√®s-Vente) de Machines</h3>
        <p>Voici la structure de la base de donn√©es :</p>

        <h4>Tables :</h4>
        <div class="example">
            <h5>1Ô∏è‚É£ Machines</h5>
            <ul>
                <li><strong>id</strong> (INT, PK) ‚Üí Identifiant unique de la machine</li>
                <li><strong>reference</strong> (VARCHAR(50)) ‚Üí R√©f√©rence de la machine</li>
                <li><strong>modele</strong> (VARCHAR(100)) ‚Üí Mod√®le de la machine</li>
                <li><strong>date_achat</strong> (DATE) ‚Üí Date d'achat de la machine</li>
            </ul>

            <h5>2Ô∏è‚É£ Clients</h5>
            <ul>
                <li><strong>id</strong> (INT, PK) ‚Üí Identifiant unique du client</li>
                <li><strong>nom</strong> (VARCHAR(100)) ‚Üí Nom du client</li>
                <li><strong>prenom</strong> (VARCHAR(100)) ‚Üí Pr√©nom du client</li>
                <li><strong>email</strong> (VARCHAR(100), UNIQUE) ‚Üí Email du client</li>
                <li><strong>telephone</strong> (VARCHAR(15)) ‚Üí T√©l√©phone du client</li>
            </ul>

            <h5>3Ô∏è‚É£ Techniciens</h5>
            <ul>
                <li><strong>id</strong> (INT, PK) ‚Üí Identifiant unique du technicien</li>
                <li><strong>nom</strong> (VARCHAR(100)) ‚Üí Nom du technicien</li>
                <li><strong>prenom</strong> (VARCHAR(100)) ‚Üí Pr√©nom du technicien</li>
                <li><strong>specialite</strong> (VARCHAR(100)) ‚Üí Sp√©cialit√© du technicien</li>
            </ul>

            <h5>4Ô∏è‚É£ Interventions</h5>
            <ul>
                <li><strong>id</strong> (INT, PK) ‚Üí Identifiant unique de l'intervention</li>
                <li><strong>machine_id</strong> (INT, FK ‚Üí Machines.id) ‚Üí Machine concern√©e</li>
                <li><strong>client_id</strong> (INT, FK ‚Üí Clients.id) ‚Üí Client propri√©taire</li>
                <li><strong>technicien_id</strong> (INT, FK ‚Üí Techniciens.id) ‚Üí Technicien en charge</li>
                <li><strong>date_intervention</strong> (DATE) ‚Üí Date de l'intervention</li>
                <li><strong>description</strong> (TEXT) ‚Üí Description du probl√®me et de l'intervention</li>
                <li><strong>statut</strong> (VARCHAR(50)) ‚Üí Statut de l'intervention (En cours, Termin√©e, Annul√©e)</li>
            </ul>
        </div>

        <h4>üîé 10 Questions SQL (Niveau Croissant) :</h4>
        <div class="example">
            <h5>1Ô∏è‚É£ Lister toutes les machines avec leur r√©f√©rence et leur mod√®le</h5>
            <code>
                SELECT reference, modele 
                FROM Machines;
            </code>

            <h5>2Ô∏è‚É£ Afficher la liste des clients avec leur nom, pr√©nom et email</h5>
            <code>
                SELECT nom, prenom, email 
                FROM Clients;
            </code>

            <h5>3Ô∏è‚É£ Trouver toutes les interventions r√©alis√©es apr√®s le 1er janvier 2023</h5>
            <code>
                SELECT * 
                FROM Interventions 
                WHERE date_intervention > '2023-01-01';
            </code>

            <h5>4Ô∏è‚É£ Afficher le nombre total d'interventions enregistr√©es</h5>
            <code>
                SELECT COUNT(*) AS nombre_interventions 
                FROM Interventions;
            </code>

            <h5>5Ô∏è‚É£ Lister les interventions avec le nom du client, la r√©f√©rence de la machine et la date d'intervention</h5>
            <code>
                SELECT c.nom AS client, c.prenom, m.reference AS machine, i.date_intervention 
                FROM Interventions i
                JOIN Clients c ON i.client_id = c.id
                JOIN Machines m ON i.machine_id = m.id;
            </code>

            <h5>6Ô∏è‚É£ Afficher les techniciens et le nombre d'interventions qu'ils ont r√©alis√©es</h5>
            <code>
                SELECT t.nom, t.prenom, COUNT(i.id) AS nombre_interventions
                FROM Techniciens t
                LEFT JOIN Interventions i ON t.id = i.technicien_id
                GROUP BY t.nom, t.prenom;
            </code>

            <h5>7Ô∏è‚É£ Afficher le nombre de machines poss√©d√©es par chaque client</h5>
            <code>
                SELECT c.nom, c.prenom, COUNT(m.id) AS nombre_machines
                FROM Clients c
                JOIN Machines m ON c.id = m.id
                GROUP BY c.nom, c.prenom;
            </code>

            <h5>8Ô∏è‚É£ Lister les clients ayant eu plus de 3 interventions</h5>
            <code>
                SELECT c.nom, c.prenom, COUNT(i.id) AS nombre_interventions
                FROM Clients c
                JOIN Interventions i ON c.id = i.client_id
                GROUP BY c.nom, c.prenom
                HAVING COUNT(i.id) > 3;
            </code>

            <h5>9Ô∏è‚É£ Afficher l'√¢ge moyen des machines en ann√©es</h5>
            <code>
                SELECT ROUND(AVG(YEAR(CURDATE()) - YEAR(date_achat))) AS age_moyen
                FROM Machines;
            </code>

            <h5>üîü Trouver les techniciens qui ont travaill√© sur plusieurs interventions pour la m√™me machine</h5>
            <code>
                SELECT i.machine_id, t.nom, t.prenom, COUNT(i.id) AS nombre_interventions
                FROM Interventions i
                JOIN Techniciens t ON i.technicien_id = t.id
                GROUP BY i.machine_id, t.nom, t.prenom
                HAVING COUNT(i.id) > 1;
            </code>
        </div>

    </div>
</body>
</html>
